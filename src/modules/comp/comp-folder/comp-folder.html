<div class="home-container">
 <!-- æ‰“å¼€æ¨¡æ€æ¡†çš„æŒ‰é’® -->
 <button class="open-modal-btn" (click)="openModal()">æ‰“å¼€æ–‡ä»¶ç®¡ç†å™¨</button>

 <!-- æ¨¡æ€æ¡†é®ç½©å±‚ -->
 <div class="modal-wrapper" *ngIf="isModalOpen" @modalAnimation>
  <div class="modal-content">

   <!-- ç‚¹å‡»å…³é—­æŒ‰é’® -->
   <span class="close-btn" (click)="closeModal()">&times;</span>

   <!-- åŸå§‹çš„ file-manager å†…å®¹ -->
   <div class="file-manager">
    <!-- Loading Overlay -->
    <div class="loading-overlay" *ngIf="loading">
     <div class="spinner"></div>
    </div>

    <div class="search-wrapper">
     <i class="material-icons search-icon">search</i>
     <input type="text"
            placeholder="ğŸ” æœç´¢æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹..."
            [(ngModel)]="searchQuery"
            [ngModelOptions]="{standalone: true}"
            class="search-input">
    </div>

    <!-- Toolbar -->
    <div class="toolbar">
     <div class="breadcrumb">
          <span *ngFor="let path of currentPath; let i = index"
                (click)="i !== pathStack.length - 1 && goToBreadcrumb(i)">
            {{ path }}
           <span *ngIf="i < currentPath.length - 1"> &gt; </span>
          </span>
     </div>

     <div class="actions">
      <button (click)="createFolder()">æ–°å»ºæ–‡ä»¶å¤¹</button>
      <button (click)="deleteSelected()" [disabled]="selectedItems.length === 0">åˆ é™¤</button>
      <button (click)="renameItem()" [disabled]="selectedItems.length !== 1">é‡å‘½å</button>
      <button (click)="openCopyMoveDialog('copy')" [disabled]="selectedItems.length === 0">å¤åˆ¶</button>
      <button (click)="openCopyMoveDialog('move')" [disabled]="selectedItems.length === 0">ç§»åŠ¨</button>
      <input type="file" (change)="uploadFile($event)" multiple style="display: none" #fileInput/>
      <button (click)="fileInput.click()">ä¸Šä¼ æ–‡ä»¶</button>
     </div>

     <div class="view-toggle">
      <button [class.active]="viewMode === 'grid'" (click)="toggleView('grid')">ç½‘æ ¼</button>
      <button [class.active]="viewMode === 'list'" (click)="toggleView('list')">åˆ—è¡¨</button>
     </div>
    </div>

    <!-- Go Back Button -->
    <button (click)="goBack()" [disabled]="pathStack.length <= 1" class="back-button">â† è¿”å›ä¸Šä¸€çº§</button>

    <!-- File List -->
    <div class="file-list" [class.grid]="viewMode === 'grid'" [class.list]="viewMode === 'list'">
     <div *ngFor="let item of displayedItems"
          class="file-item"
          [class.selected]="isItemSelected(item)"
          (click)="selectItem(item)"
          (dblclick)="item.type === 'folder' ? navigateTo(item) : null">
      <div class="icon">
       <i class="material-icons">{{ item.type === 'folder' ? 'folder' : 'insert_drive_file' }}</i>
      </div>
      <div class="name">{{ item.name }}</div>
     </div>
    </div>

    <!-- Copy/Move Dialog -->
    <div class="dialog" *ngIf="showCopyMoveDialog">
     <div class="dialog-content">
      <h3>{{ copyMoveAction === 'copy' ? 'å¤åˆ¶' : 'ç§»åŠ¨' }}åˆ°</h3>
      <select [(ngModel)]="targetFolder" [ngModelOptions]="{standalone: true}">
       <option [ngValue]="null">è¯·é€‰æ‹©ç›®æ ‡æ–‡ä»¶å¤¹</option>
       <option *ngFor="let folder of getAllFolders()" [ngValue]="folder">
        {{ folder.name }}
       </option>
      </select>

      <div class="dialog-actions">
       <button (click)="confirmCopyMove()" [disabled]="!targetFolder">ç¡®è®¤</button>
       <button (click)="cancelCopyMove()">å–æ¶ˆ</button>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>