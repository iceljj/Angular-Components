<div class="home-container">
 <!-- 打开模态框的按钮 -->
 <button class="open-modal-btn" (click)="openModal()">打开文件管理器</button>

 <!-- 模态框遮罩层 -->
 <div class="modal-wrapper" *ngIf="isModalOpen" @modalAnimation>
  <div class="modal-content">

   <!-- 点击关闭按钮 -->
   <span class="close-btn" (click)="closeModal()">&times;</span>

   <!-- 原始的 file-manager 内容 -->
   <div class="file-manager">
    <!-- Loading Overlay -->
    <div class="loading-overlay" *ngIf="loading">
     <div class="spinner"></div>
    </div>

    <div class="search-wrapper">
     <i class="material-icons search-icon">search</i>
     <input type="text"
            placeholder="🔍 搜索文件或文件夹..."
            [(ngModel)]="searchQuery"
            [ngModelOptions]="{standalone: true}"
            class="search-input">
    </div>

    <!-- Toolbar -->
    <div class="toolbar">
     <div class="breadcrumb">
          <span *ngFor="let path of currentPath; let i = index"
                (click)="i !== pathStack.length - 1 && goToBreadcrumb(i)">
            {{ path }}
           <span *ngIf="i < currentPath.length - 1"> &gt; </span>
          </span>
     </div>

     <div class="actions">
      <button (click)="createFolder()">新建文件夹</button>
      <button (click)="deleteSelected()" [disabled]="selectedItems.length === 0">删除</button>
      <button (click)="renameItem()" [disabled]="selectedItems.length !== 1">重命名</button>
      <button (click)="openCopyMoveDialog('copy')" [disabled]="selectedItems.length === 0">复制</button>
      <button (click)="openCopyMoveDialog('move')" [disabled]="selectedItems.length === 0">移动</button>
      <input type="file" (change)="uploadFile($event)" multiple style="display: none" #fileInput/>
      <button (click)="fileInput.click()">上传文件</button>
     </div>

     <div class="view-toggle">
      <button [class.active]="viewMode === 'grid'" (click)="toggleView('grid')">网格</button>
      <button [class.active]="viewMode === 'list'" (click)="toggleView('list')">列表</button>
     </div>
    </div>

    <!-- Go Back Button -->
    <button (click)="goBack()" [disabled]="pathStack.length <= 1" class="back-button">← 返回上一级</button>

    <!-- File List -->
    <div class="file-list" [class.grid]="viewMode === 'grid'" [class.list]="viewMode === 'list'">
     <div *ngFor="let item of displayedItems"
          class="file-item"
          [class.selected]="isItemSelected(item)"
          (click)="selectItem(item)"
          (dblclick)="item.type === 'folder' ? navigateTo(item) : null">
      <div class="icon">
       <i class="material-icons">{{ item.type === 'folder' ? 'folder' : 'insert_drive_file' }}</i>
      </div>
      <div class="name">{{ item.name }}</div>
     </div>
    </div>

    <!-- Copy/Move Dialog -->
    <div class="dialog" *ngIf="showCopyMoveDialog">
     <div class="dialog-content">
      <h3>{{ copyMoveAction === 'copy' ? '复制' : '移动' }}到</h3>
      <select [(ngModel)]="targetFolder" [ngModelOptions]="{standalone: true}">
       <option [ngValue]="null">请选择目标文件夹</option>
       <option *ngFor="let folder of getAllFolders()" [ngValue]="folder">
        {{ folder.name }}
       </option>
      </select>

      <div class="dialog-actions">
       <button (click)="confirmCopyMove()" [disabled]="!targetFolder">确认</button>
       <button (click)="cancelCopyMove()">取消</button>
      </div>
     </div>
    </div>
   </div>
  </div>
 </div>
</div>