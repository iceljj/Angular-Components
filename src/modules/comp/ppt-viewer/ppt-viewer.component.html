<div class="ppt-viewer-container">
    <!-- æ–‡ä»¶ä¸Šä¼ åŒºåŸŸ -->
    <div class="upload-section" *ngIf="!isLoading && !error">
        <div class="upload-area" (click)="triggerFileInput()">
            <i class="upload-icon">ğŸ“</i>
            <h3>ç‚¹å‡»ä¸Šä¼ PPTXæ–‡ä»¶</h3>
            <p>æ”¯æŒ .pptx æ ¼å¼ï¼Œæ–‡ä»¶å¤§å°ä¸è¶…è¿‡50MB</p>
            <button class="upload-btn">é€‰æ‹©æ–‡ä»¶</button>
        </div>
        <input #fileInput type="file" accept=".pptx" (change)="onFileSelected($event)" style="display: none;"/>
    </div>

    <!-- åŠ è½½çŠ¶æ€ -->
    <div class="loading-section" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>æ­£åœ¨åŠ è½½PPTæ–‡ä»¶... {{ loadProgress }}%</p>
        <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="loadProgress"></div>
        </div>
    </div>

    <!-- é”™è¯¯ä¿¡æ¯ -->
    <div class="error-section" *ngIf="error && !isLoading">
        <div class="error-icon">âš ï¸</div>
        <h3>åŠ è½½å¤±è´¥</h3>
        <p>{{ error }}</p>
        <button class="retry-btn" (click)="triggerFileInput()">é‡æ–°ä¸Šä¼ </button>
    </div>

    <!-- PPTå®¹å™¨ - å§‹ç»ˆå­˜åœ¨ -->
    <div class="ppt-container-wrapper"
         (click)="handleContainerClick($event)"
         (contextmenu)="handleContainerContextMenu($event)"
         (wheel)="handleContainerWheel($event)">
        <div #pptContainer class="ppt-container" [style.transform]="'scale(' + scale + ')'"></div>
        
        <!-- è‡ªå®šä¹‰å¯¼èˆªæ§ä»¶ -->
        <div class="custom-navigation" *ngIf="slides.length > 0 && !isLoading && !error">
            <!-- ä¸Šä¸€é¡µæŒ‰é’® -->
            <div class="nav-btn prev-btn" (click)="prevSlide($event)" 
                 [class.disabled]="currentSlideIndex === 0">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"/>
                </svg>
            </div>
            
            <!-- ä¸‹ä¸€é¡µæŒ‰é’® -->
            <div class="nav-btn next-btn" (click)="nextSlide($event)" 
                 [class.disabled]="currentSlideIndex === slides.length - 1">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </div>
            
            <!-- é¡µç æ˜¾ç¤º -->
            <div class="page-indicator">
                {{ currentSlideIndex + 1 }} / {{ slides.length }}
            </div>
        </div>
    </div>

    <!-- å·¥å…·æ  -->
    <div class="toolbar" *ngIf="!isLoading && !error">
        <div class="toolbar-group">
            <!-- ç¼©æ”¾æ§åˆ¶ -->
            <button class="toolbar-btn" (click)="zoomOut()" [disabled]="scale <= 0.5">
                <i class="icon">â–</i>
            </button>
            <span class="zoom-info">{{ (scale * 100) | number:'1.0-0' }}%</span>
            <button class="toolbar-btn" (click)="zoomIn()" [disabled]="scale >= 3">
                <i class="icon">â•</i>
            </button>
            <button class="toolbar-btn" (click)="resetZoom()">
                <i class="icon">ğŸ”„</i>
            </button>
        </div>

        <div class="toolbar-group">
            <!-- æ›´æ¢PPTæŒ‰é’® -->
            <button class="toolbar-btn change-ppt-btn" (click)="triggerFileInput()">
                <i class="icon">ğŸ”„</i>
                <span>æ›´æ¢PPT</span>
            </button>

            <!-- å…¨å±æŒ‰é’® -->
            <button class="toolbar-btn fullscreen-btn" (click)="toggleFullscreen()">
                <i class="icon">{{ isFullscreen ? 'ğŸ“±' : 'ğŸ“º' }}</i>
                <span>{{ isFullscreen ? 'é€€å‡ºå…¨å±' : 'å…¨å±' }}</span>
            </button>
        </div>
    </div>
</div>
