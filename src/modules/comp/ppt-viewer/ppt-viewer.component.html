<div class="ppt-viewer-container">
    <!-- 文件上传区域 -->
    <div class="upload-section" *ngIf="!isLoading && !error">
        <div class="upload-area" (click)="triggerFileInput()">
            <i class="upload-icon">📁</i>
            <h3>点击上传PPTX文件</h3>
            <p>支持 .pptx 格式，文件大小不超过50MB</p>
            <button class="upload-btn">选择文件</button>
        </div>
        <input #fileInput type="file" accept=".pptx" (change)="onFileSelected($event)" style="display: none;"/>
    </div>

    <!-- 加载状态 -->
    <div class="loading-section" *ngIf="isLoading">
        <div class="spinner"></div>
        <p>正在加载PPT文件... {{ loadProgress }}%</p>
        <div class="progress-bar">
            <div class="progress-fill" [style.width.%]="loadProgress"></div>
        </div>
    </div>

    <!-- 错误信息 -->
    <div class="error-section" *ngIf="error && !isLoading">
        <div class="error-icon">⚠️</div>
        <h3>加载失败</h3>
        <p>{{ error }}</p>
        <button class="retry-btn" (click)="triggerFileInput()">重新上传</button>
    </div>

    <!-- PPT容器 - 始终存在 -->
    <div class="ppt-container-wrapper"
         (click)="handleContainerClick($event)"
         (contextmenu)="handleContainerContextMenu($event)"
         (wheel)="handleContainerWheel($event)">
        <div #pptContainer class="ppt-container" [style.transform]="'scale(' + scale + ')'"></div>
        
        <!-- 自定义导航控件 -->
        <div class="custom-navigation" *ngIf="slides.length > 0 && !isLoading && !error">
            <!-- 上一页按钮 -->
            <div class="nav-btn prev-btn" (click)="prevSlide($event)" 
                 [class.disabled]="currentSlideIndex === 0">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M15 18l-6-6 6-6"/>
                </svg>
            </div>
            
            <!-- 下一页按钮 -->
            <div class="nav-btn next-btn" (click)="nextSlide($event)" 
                 [class.disabled]="currentSlideIndex === slides.length - 1">
                <svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 18l6-6-6-6"/>
                </svg>
            </div>
            
            <!-- 页码显示 -->
            <div class="page-indicator">
                {{ currentSlideIndex + 1 }} / {{ slides.length }}
            </div>
        </div>
    </div>

    <!-- 工具栏 -->
    <div class="toolbar" *ngIf="!isLoading && !error">
        <div class="toolbar-group">
            <!-- 缩放控制 -->
            <button class="toolbar-btn" (click)="zoomOut()" [disabled]="scale <= 0.5">
                <i class="icon">➖</i>
            </button>
            <span class="zoom-info">{{ (scale * 100) | number:'1.0-0' }}%</span>
            <button class="toolbar-btn" (click)="zoomIn()" [disabled]="scale >= 3">
                <i class="icon">➕</i>
            </button>
            <button class="toolbar-btn" (click)="resetZoom()">
                <i class="icon">🔄</i>
            </button>
        </div>

        <div class="toolbar-group">
            <!-- 更换PPT按钮 -->
            <button class="toolbar-btn change-ppt-btn" (click)="triggerFileInput()">
                <i class="icon">🔄</i>
                <span>更换PPT</span>
            </button>

            <!-- 全屏按钮 -->
            <button class="toolbar-btn fullscreen-btn" (click)="toggleFullscreen()">
                <i class="icon">{{ isFullscreen ? '📱' : '📺' }}</i>
                <span>{{ isFullscreen ? '退出全屏' : '全屏' }}</span>
            </button>
        </div>
    </div>
</div>
