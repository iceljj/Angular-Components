<div class="low-code-platform">
  <!-- 顶部工具栏 -->
  <header class="toolbar">
    <div class="logo">
      <span class="material-icons">design_services</span>
      <h1>Mobile Designer</h1>
    </div>

    <div class="actions">
      <button (click)="saveDesign()" class="action-btn">
        <span class="material-icons">save</span>
        <span>保存</span>
      </button>
      <button (click)="previewDesign()" class="action-btn">
        <span class="material-icons">preview</span>
        <span>预览</span>
      </button>
      <button (click)="exportCode()" class="action-btn">
        <span class="material-icons">code</span>
        <span>导出代码</span>
      </button>

      <div class="device-selector">
        <span>设备:</span>
        <select [(ngModel)]="devicePreview" (change)="changeDevice(devicePreview)">
          <option *ngFor="let device of deviceOptions" [value]="device.id">{{device.name}}</option>
        </select>
      </div>

      <div class="zoom-controls">
        <button (click)="changeZoom('out')" class="zoom-btn">
          <span class="material-icons">remove</span>
        </button>
        <span>{{zoomLevel}}%</span>
        <button (click)="changeZoom('in')" class="zoom-btn">
          <span class="material-icons">add</span>
        </button>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <div class="main-content">
    <!-- 左侧组件面板 -->
    <aside class="components-panel">
      <h3>组件库</h3>
      <div class="components-grid">
        <div
          *ngFor="let comp of components"
          class="component-item"
          draggable="true"
          (dragstart)="dragStart($event, comp)"
        >
          <span class="material-icons">{{comp.icon}}</span>
          <span>{{comp.name}}</span>
        </div>
      </div>
    </aside>

    <!-- 中间画布区域 -->
    <main class="canvas-container">
      <div class="canvas-wrapper" [class.iphone-x]="devicePreview === 'iphone-x'"
           [class.samsung-s10]="devicePreview === 'samsung-s10'"
           [class.pixel-5]="devicePreview === 'pixel-5'"
           [style.transform]="'scale(' + (zoomLevel/100) + ')'">
        <div
          #canvas
          class="canvas"
          (dragover)="dragEnd($event)"
          (drop)="drop($event)"
        >
          <!-- 动态生成的组件 -->
          <div
            *ngFor="let comp of canvasComponents"
            class="component"
            [class.selected]="selectedComponent?.id === comp.id"
            [style.left.px]="comp.x"
            [style.top.px]="comp.y"
            [style.width.px]="comp.width"
            [style.height.px]="comp.height"
            [style.border-color]="comp.color"
            (click)="selectComponent(comp)"
          >
            <!-- 按钮组件 -->
            <div *ngIf="comp.type === 'button'" class="button-component"
                 [style.background]="comp.props.color"
                 [style.font-size.px]="comp.props.fontSize">
              {{comp.props.text}}
            </div>

            <!-- 输入框组件 -->
            <div *ngIf="comp.type === 'input'" class="input-component">
              <input type="text" [placeholder]="comp.props.placeholder">
            </div>

            <!-- 图片组件 -->
            <div *ngIf="comp.type === 'image'" class="image-component">
              <img [src]="comp.props.src" [alt]="comp.props.alt">
            </div>

            <!-- 卡片组件 -->
            <div *ngIf="comp.type === 'card'" class="card-component"
                 [style.background]="comp.props.backgroundColor">
              <h4>{{comp.props.title}}</h4>
              <p>{{comp.props.content}}</p>
            </div>

            <!-- 开关组件 -->
            <div *ngIf="comp.type === 'toggle'" class="toggle-component">
              <label class="switch">
                <input type="checkbox" [checked]="comp.props.checked">
                <span class="slider round"></span>
              </label>
            </div>

            <!-- 滑块组件 -->
            <div *ngIf="comp.type === 'slider'" class="slider-component">
              <input type="range" [min]="comp.props.min" [max]="comp.props.max"
                     [value]="comp.props.value">
            </div>

            <!-- 组件操作按钮 -->
            <div class="component-actions" *ngIf="selectedComponent?.id === comp.id">
              <button class="action delete" (click)="deleteComponent()">
                <span class="material-icons">delete</span>
              </button>
              <button class="action duplicate" (click)="duplicateComponent()">
                <span class="material-icons">content_copy</span>
              </button>
            </div>
          </div>

          <!-- 拖拽提示 -->
          <div class="drop-hint" *ngIf="!canvasComponents.length">
            <div class="hint-content">
              <span class="material-icons">backup</span>
              <p>拖拽组件到此处开始设计</p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- 右侧属性面板 -->
    <aside class="properties-panel">
      <h3>属性编辑器</h3>

      <div class="no-selection" *ngIf="!selectedComponent">
        <span class="material-icons">info</span>
        <p>请选择一个组件进行编辑</p>
      </div>

      <div class="properties-form" *ngIf="selectedComponent">
        <div class="form-group">
          <label>位置 X</label>
          <input type="number" [(ngModel)]="selectedComponent.x">
        </div>

        <div class="form-group">
          <label>位置 Y</label>
          <input type="number" [(ngModel)]="selectedComponent.y">
        </div>

        <div class="form-group">
          <label>宽度</label>
          <input type="number" [(ngModel)]="selectedComponent.width">
        </div>

        <div class="form-group">
          <label>高度</label>
          <input type="number" [(ngModel)]="selectedComponent.height">
        </div>

        <div *ngIf="selectedComponent.type === 'button'">
          <div class="form-group">
            <label>按钮文字</label>
            <input type="text" [(ngModel)]="selectedComponent.props.text">
          </div>

          <div class="form-group">
            <label>背景颜色</label>
            <input type="color" [(ngModel)]="selectedComponent.props.color">
          </div>

          <div class="form-group">
            <label>字体大小</label>
            <input type="range" min="10" max="24" [(ngModel)]="selectedComponent.props.fontSize">
            <span>{{selectedComponent.props.fontSize}}px</span>
          </div>
        </div>

        <div *ngIf="selectedComponent.type === 'input'">
          <div class="form-group">
            <label>占位符</label>
            <input type="text" [(ngModel)]="selectedComponent.props.placeholder">
          </div>
        </div>

        <div *ngIf="selectedComponent.type === 'image'">
          <div class="form-group">
            <label>图片 URL</label>
            <input type="text" [(ngModel)]="selectedComponent.props.src">
          </div>

          <div class="form-group">
            <label>替代文本</label>
            <input type="text" [(ngModel)]="selectedComponent.props.alt">
          </div>
        </div>
      </div>
    </aside>
  </div>

  <!-- 底部状态栏 -->
  <footer class="status-bar">
    <div class="status-item">
      <span>组件数: {{canvasComponents.length}}</span>
    </div>
    <div class="status-item">
      <span>画布大小: 375×812</span>
    </div>
    <div class="status-item">
      <span>低代码平台 v1.0</span>
    </div>
  </footer>
</div>
