<!-- comp-drop-down-toggle.component.html -->
<div class="slider-container">
  <!-- 左侧滑动按钮 -->
  <button class="nav-button left"
          [class.disabled]="isFirstItem"
          (click)="slideLeft()"
          aria-label="Previous item">
    &lt;
  </button>

  <!-- 中间选择区域 -->
  <div class="selection-area"
       (click)="toggleDropdown()"
       aria-haspopup="listbox"
       [attr.aria-expanded]="isDropdownOpen">
    <div class="mode-toggle" (click)="toggleMode($event)">
      <span class="mode-icon" [class.multi]="isMultiSelectMode">⦿</span>
    </div>

    <div class="current-label">
      <!-- 单选模式显示位置和名称 -->
      <ng-container *ngIf="!isMultiSelectMode">
        <span class="position-indicator">{{ currentIndex + 1 }}/{{ dataArray.length }}</span>
        {{ currentItem.label || '请选择' }}
      </ng-container>

      <!-- 多选模式显示选中数量 -->
      <ng-container *ngIf="isMultiSelectMode">
        <span class="badge">{{ selectedIds.size }}项已选</span>
      </ng-container>

      <span class="dropdown-icon" [class.rotated]="isDropdownOpen">▼</span>
    </div>
  </div>

  <!-- 右侧滑动按钮 -->
  <button class="nav-button right"
          [class.disabled]="isLastItem"
          (click)="slideRight()"
          aria-label="Next item">
    &gt;
  </button>

  <!-- 下拉卡片菜单 -->
  <div class="dropdown-container"
       *ngIf="isDropdownOpen"
       @dropdownAnimation
       role="listbox">
    <div class="dropdown-header">
      <div class="select-all-container">
        <button class="select-all-button" (click)="toggleSelectAll($event)">
          {{ isAllSelected() ? '取消全选' : '全选' }}
        </button>
      </div>

      <div class="mode-indicator">
        <span class="mode-label" [class.active]="!isMultiSelectMode">单选</span>
        <label class="switch">
          <input type="checkbox" [checked]="isMultiSelectMode" (change)="toggleMode($event)">
          <span class="slider"></span>
        </label>
        <span class="mode-label" [class.active]="isMultiSelectMode">多选</span>
      </div>
    </div>

    <div class="card-grid" #cardList>
      <div class="card-item"
           *ngFor="let item of dataArray; let i = index"
           [class.selected]="isItemSelected(item.id)"
           (click)="selectCard(item.id, $event)"
           role="option"
           [attr.aria-selected]="isItemSelected(item.id)">
        <div class="card-content">
          {{ item.label }}
          <span class="checkmark" *ngIf="isItemSelected(item.id)">✓</span>
        </div>
      </div>
    </div>
  </div>
</div>
