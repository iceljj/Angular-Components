import"./chunk-7UZYWCAJ.js";import{c as R,d as j,f as M,g as C,i as B}from"./chunk-WU746J7T.js";import{t as N}from"./chunk-LM5MDKJD.js";import{j as V,k as F,o as L}from"./chunk-3BOVJI26.js";import{Bb as k,Ga as S,Ja as I,Kb as _,Sb as g,Tb as o,Ub as a,Vb as D,Zb as b,_b as w,ac as v,fb as O,fc as d,gb as i,hc as p,lb as P,lc as A,mc as T,nc as E,ra as h,sa as x,sb as y,sc as u,vc as s,xc as m,yb as f,yc as z}from"./chunk-SV3L42UN.js";import"./chunk-IJBWTILK.js";var Y=["cardList"];function $(r,t){if(r&1&&(b(0),o(1,"span",11),s(2),a(),s(3),w()),r&2){let e=p();i(2),z("",e.currentIndex+1,"/",e.dataArray.length),i(),m(" ",e.currentItem.label||"\u8BF7\u9009\u62E9"," ")}}function q(r,t){if(r&1&&(b(0),o(1,"span",12),s(2),a(),w()),r&2){let e=p();i(2),m("",e.selectedIds.size,"\u9879\u5DF2\u9009")}}function U(r,t){r&1&&(o(0,"span",27),s(1,"\u2713"),a())}function G(r,t){if(r&1){let e=v();o(0,"div",24),d("click",function(l){let c=h(e).$implicit,Q=p(2);return x(Q.selectCard(c.id,l))}),o(1,"div",25),s(2),f(3,U,2,0,"span",26),a()()}if(r&2){let e=t.$implicit,n=p(2);u("selected",n.isItemSelected(e.id)),_("aria-selected",n.isItemSelected(e.id)),i(2),m(" ",e.label," "),i(),g("ngIf",n.isItemSelected(e.id))}}function J(r,t){if(r&1){let e=v();o(0,"div",13)(1,"div",14)(2,"div",15)(3,"button",16),d("click",function(l){h(e);let c=p();return x(c.toggleSelectAll(l))}),s(4),a()(),o(5,"div",17)(6,"span",18),s(7,"\u5355\u9009"),a(),o(8,"label",19)(9,"input",20),d("change",function(l){h(e);let c=p();return x(c.toggleMode(l))}),a(),D(10,"span",21),a(),o(11,"span",18),s(12,"\u591A\u9009"),a()()(),o(13,"div",22,0),f(15,G,4,5,"div",23),a()()}if(r&2){let e=p();g("@dropdownAnimation",void 0),i(4),m(" ",e.isAllSelected()?"\u53D6\u6D88\u5168\u9009":"\u5168\u9009"," "),i(2),u("active",!e.isMultiSelectMode),i(3),g("checked",e.isMultiSelectMode),i(2),u("active",e.isMultiSelectMode),i(4),g("ngForOf",e.dataArray)}}var H=class r{constructor(t){this.elementRef=t}dataArray=[];selectionChange=new k;currentIndex=0;isDropdownOpen=!1;cardListRef;selectedIds=new Set;isMultiSelectMode=!1;lastSingleSelectedId=null;get isFirstItem(){return this.currentIndex===0||this.dataArray.length===0}get isLastItem(){return this.currentIndex===this.dataArray.length-1||this.dataArray.length===0}get currentItem(){return this.dataArray.length===0?null:this.dataArray[this.currentIndex]}ngAfterViewInit(){}ngOnChanges(t){t.dataArray&&(this.selectedIds.clear(),this.lastSingleSelectedId=null,this.ensureValidSelection(),this.emitSelection())}onClickOutside(t){this.elementRef.nativeElement.contains(t.target)||this.closeDropdown()}ensureValidSelection(){if(this.dataArray.length===0){this.currentIndex=0;return}this.currentIndex>=this.dataArray.length&&(this.currentIndex=0),this.currentItem||(this.currentIndex=0)}slideLeft(){this.isFirstItem||(this.switchToSingleMode(),this.currentIndex--,this.selectCurrentItemAsSingle(),this.closeDropdown())}slideRight(){this.isLastItem||(this.switchToSingleMode(),this.currentIndex++,this.selectCurrentItemAsSingle(),this.closeDropdown())}switchToSingleMode(){this.isMultiSelectMode&&(this.isMultiSelectMode=!1,this.restoreLastSingleSelection())}restoreLastSingleSelection(){if(this.lastSingleSelectedId!==null){let t=this.dataArray.findIndex(e=>e.id===this.lastSingleSelectedId);t!==-1&&(this.currentIndex=t),this.selectedIds=new Set([this.lastSingleSelectedId])}else this.selectCurrentItemAsSingle()}selectCurrentItemAsSingle(){this.currentItem&&(this.selectedIds=new Set([this.currentItem.id]),this.lastSingleSelectedId=this.currentItem.id,this.emitSelection())}toggleDropdown(){this.isDropdownOpen=!this.isDropdownOpen}closeDropdown(){this.isDropdownOpen=!1}selectCard(t,e){e&&e.stopPropagation(),this.isMultiSelectMode?this.selectedIds.has(t)?this.selectedIds.delete(t):this.selectedIds.add(t):(this.selectedIds=new Set([t]),this.lastSingleSelectedId=t);let n=this.dataArray.findIndex(l=>l.id===t);n!==-1&&(this.currentIndex=n),this.emitSelection()}emitSelection(){if(this.dataArray.length>0){let t=this.dataArray.filter(e=>this.selectedIds.has(e.id));this.selectionChange.emit(t)}else this.selectionChange.emit([])}isItemSelected(t){return this.selectedIds.has(t)}toggleSelectAll(t){t.stopPropagation(),this.isAllSelected()?this.selectedIds.clear():this.dataArray.forEach(e=>{this.selectedIds.add(e.id)}),this.emitSelection()}isAllSelected(){return this.dataArray.length>0&&this.selectedIds.size===this.dataArray.length}toggleMode(t){t.stopPropagation();let e=this.isMultiSelectMode;this.isMultiSelectMode=!this.isMultiSelectMode,e&&!this.isMultiSelectMode?this.restoreLastSingleSelection():!e&&this.isMultiSelectMode&&this.currentItem&&(this.lastSingleSelectedId=this.currentItem.id)}static \u0275fac=function(e){return new(e||r)(P(I))};static \u0275cmp=y({type:r,selectors:[["comp-drop-down-toggle"]],viewQuery:function(e,n){if(e&1&&A(Y,5),e&2){let l;T(l=E())&&(n.cardListRef=l.first)}},hostBindings:function(e,n){e&1&&d("click",function(c){return n.onClickOutside(c)},O)},inputs:{dataArray:"dataArray"},outputs:{selectionChange:"selectionChange"},features:[S],decls:15,vars:12,consts:[["cardList",""],[1,"slider-container"],["aria-label","Previous item",1,"nav-button","left",3,"click"],["aria-haspopup","listbox",1,"selection-area",3,"click"],[1,"mode-toggle",3,"click"],[1,"mode-icon"],[1,"current-label"],[4,"ngIf"],[1,"dropdown-icon"],["aria-label","Next item",1,"nav-button","right",3,"click"],["class","dropdown-container","role","listbox",4,"ngIf"],[1,"position-indicator"],[1,"badge"],["role","listbox",1,"dropdown-container"],[1,"dropdown-header"],[1,"select-all-container"],[1,"select-all-button",3,"click"],[1,"mode-indicator"],[1,"mode-label"],[1,"switch"],["type","checkbox",3,"change","checked"],[1,"slider"],[1,"card-grid"],["class","card-item","role","option",3,"selected","click",4,"ngFor","ngForOf"],["role","option",1,"card-item",3,"click"],[1,"card-content"],["class","checkmark",4,"ngIf"],[1,"checkmark"]],template:function(e,n){e&1&&(o(0,"div",1)(1,"button",2),d("click",function(){return n.slideLeft()}),s(2," < "),a(),o(3,"div",3),d("click",function(){return n.toggleDropdown()}),o(4,"div",4),d("click",function(c){return n.toggleMode(c)}),o(5,"span",5),s(6,"\u29BF"),a()(),o(7,"div",6),f(8,$,4,3,"ng-container",7)(9,q,3,1,"ng-container",7),o(10,"span",8),s(11,"\u25BC"),a()()(),o(12,"button",9),d("click",function(){return n.slideRight()}),s(13," > "),a(),f(14,J,16,8,"div",10),a()),e&2&&(i(),u("disabled",n.isFirstItem),i(2),_("aria-expanded",n.isDropdownOpen),i(2),u("multi",n.isMultiSelectMode),i(3),g("ngIf",!n.isMultiSelectMode),i(),g("ngIf",n.isMultiSelectMode),i(),u("rotated",n.isDropdownOpen),i(2),u("disabled",n.isLastItem),i(2),g("ngIf",n.isDropdownOpen))},dependencies:[L,V,F,N],styles:['.slider-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;width:100%;height:100%;position:relative;margin:0 auto;font-family:Segoe UI,system-ui,sans-serif;z-index:100}.nav-button[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#4285f4;color:#fff;border:none;font-size:18px;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 5px #0003}.nav-button[_ngcontent-%COMP%]:hover:not(.disabled){background:#3367d6;transform:scale(1.05);box-shadow:0 4px 8px #0003}.nav-button.disabled[_ngcontent-%COMP%]{background:#e0e0e0;color:#a8a8a8;cursor:not-allowed;box-shadow:none}.selection-area[_ngcontent-%COMP%]{flex-grow:1;height:100%;margin:0 15px;position:relative;display:flex;align-items:center;background:#fff;border-radius:8px;box-shadow:0 2px 10px #0000001a;cursor:pointer;transition:all .3s ease;padding:0 15px;overflow:hidden}.selection-area[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #00000026}.mode-toggle[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:#f1f3f4;display:flex;align-items:center;justify-content:center;margin-right:10px;cursor:pointer;transition:all .3s ease}.mode-toggle[_ngcontent-%COMP%]:hover{background:#e8f0fe;transform:scale(1.1)}.mode-toggle[_ngcontent-%COMP%]   .mode-icon[_ngcontent-%COMP%]{font-size:16px;color:#5f6368;transition:all .3s ease}.mode-toggle[_ngcontent-%COMP%]   .mode-icon.multi[_ngcontent-%COMP%]{color:#34a853;transform:scale(1.2)}.current-label[_ngcontent-%COMP%]{font-size:18px;font-weight:500;color:#202124;display:flex;align-items:center;gap:10px;flex-grow:1;position:relative}.current-label[_ngcontent-%COMP%]   .position-indicator[_ngcontent-%COMP%]{background:#e8f0fe;color:#1a73e8;border-radius:12px;padding:2px 10px;font-size:14px;font-weight:600}.current-label[_ngcontent-%COMP%]   .badge[_ngcontent-%COMP%]{background:#34a853;color:#fff;border-radius:12px;padding:2px 10px;font-size:14px;font-weight:500}.dropdown-icon[_ngcontent-%COMP%]{font-size:12px;transition:transform .3s ease;margin-left:auto}.dropdown-icon.rotated[_ngcontent-%COMP%]{transform:rotate(180deg)}.dropdown-container[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;width:100%;background:#fff;border-radius:8px;box-shadow:0 4px 12px #00000026;z-index:100;overflow:hidden;margin-top:8px}.dropdown-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;border-bottom:1px solid #f0f0f0;background:#f8f9fa}.select-all-container[_ngcontent-%COMP%]{flex:1}.select-all-button[_ngcontent-%COMP%]{background:#f8f9fa;border:1px solid #dadce0;border-radius:4px;padding:6px 12px;font-size:14px;color:#5f6368;cursor:pointer;transition:all .2s ease}.select-all-button[_ngcontent-%COMP%]:hover{background:#f1f3f4;border-color:#c6c9ce}.mode-indicator[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.mode-indicator[_ngcontent-%COMP%]   .mode-label[_ngcontent-%COMP%]{font-size:14px;color:#5f6368;transition:all .3s ease}.mode-indicator[_ngcontent-%COMP%]   .mode-label.active[_ngcontent-%COMP%]{color:#1a73e8;font-weight:500}.mode-indicator[_ngcontent-%COMP%]   .switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:50px;height:24px}.mode-indicator[_ngcontent-%COMP%]   .switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.mode-indicator[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;transition:.4s;border-radius:24px}.mode-indicator[_ngcontent-%COMP%]   .slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:16px;width:16px;left:4px;bottom:4px;background-color:#fff;transition:.4s;border-radius:50%}.mode-indicator[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#34a853}.mode-indicator[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{transform:translate(26px)}.card-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;padding:16px;max-height:300px;overflow-y:auto}.card-item[_ngcontent-%COMP%]{height:80px;display:flex;align-items:center;justify-content:center;border-radius:8px;font-size:16px;color:#5f6368;transition:all .3s ease;cursor:pointer;border:1px solid #e0e0e0;background:#fff;position:relative;overflow:hidden}.card-item[_ngcontent-%COMP%]   .card-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:100%;height:100%;padding:8px;text-align:center}.card-item[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{position:absolute;top:4px;right:4px;background:#34a853;color:#fff;width:20px;height:20px;border-radius:50%;font-size:14px;display:flex;align-items:center;justify-content:center}.card-item[_ngcontent-%COMP%]:hover{border-color:#4285f4;box-shadow:0 2px 6px #4285f433}.card-item.current[_ngcontent-%COMP%]{border:2px solid #1a73e8;box-shadow:0 0 0 2px #1a73e833}.card-item.selected[_ngcontent-%COMP%]{background:#e8f0fe;border-color:#1a73e8}.card-item.selected[_ngcontent-%COMP%]   .checkmark[_ngcontent-%COMP%]{background:#1a73e8}@keyframes _ngcontent-%COMP%_pulse{0%{background-color:#fff}50%{background-color:#e8f0fe}to{background-color:#e8f0fe}}'],data:{animation:[R("dropdownAnimation",[C("void",M({opacity:0,transform:"translateY(-10px)"})),C("*",M({opacity:1,transform:"translateY(0)"})),B("void <=> *",j("200ms ease-in-out"))])]}})};export{H as DropDownToggle};
