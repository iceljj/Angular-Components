import{t as F}from"./chunk-LM5MDKJD.js";import{j as k,k as D,o as T}from"./chunk-3BOVJI26.js";import{Fc as S,Sb as p,Tb as s,Ub as u,Vb as b,ac as C,fc as v,gb as l,hc as a,kb as y,lb as P,lc as M,mc as _,nc as g,ra as d,sa as h,sb as O,sc as w,uc as I,vc as f,wc as E,yb as m}from"./chunk-SV3L42UN.js";import"./chunk-IJBWTILK.js";var A=["mainMenu"],$=["subMenu"],Q=["testArea"],B=()=>[];function H(o,e){if(o&1&&b(0,"span",13),o&2){let t=a().$implicit;I(t.icon)}}function L(o,e){o&1&&(s(0,"span",14),f(1,"\u25B6"),u())}function N(o,e){if(o&1){let t=C();s(0,"li",8),v("mouseenter",function(i){let r=d(t),c=r.$implicit,x=r.index,R=a();return h(R.onItemEnter(x,i,c))})("mouseleave",function(){let i=d(t),r=i.$implicit,c=i.index,x=a();return h(x.onItemLeave(c,r))})("click",function(){let i=d(t).$implicit,r=a();return h(r.onItemClick(i))}),s(1,"div",9),m(2,H,1,2,"span",10),s(3,"span",11),f(4),u(),m(5,L,2,0,"span",12),u()()}if(o&2){let t=e.$implicit,n=a();w("menu-item",!0)("separator",n.isSeparator(t)),l(2),p("ngIf",t.icon),l(2),E(t.label),l(),p("ngIf",n.hasChildren(t))}}function q(o,e){if(o&1&&b(0,"span",13),o&2){let t=a().$implicit;I(t.icon)}}function z(o,e){if(o&1){let t=C();s(0,"li",15),v("click",function(){let i=d(t).$implicit,r=a();return h(r.onItemClick(i))}),s(1,"div",9),m(2,q,1,2,"span",10),s(3,"span",11),f(4),u()()()}if(o&2){let t=e.$implicit,n=a();w("menu-item",!0)("separator",n.isSeparator(t)),l(2),p("ngIf",t.icon),l(2),E(t.label)}}var V=class o{constructor(e){this.renderer=e}mainMenu;subMenu;testArea;currentMenuItems=[];currentSubMenuItems=[];activeSubMenuItemIndex=null;ngAfterViewInit(){this.renderer.listen(this.testArea.nativeElement,"contextmenu",e=>{e.preventDefault(),this.showDefaultContextMenu(e.clientX,e.clientY)}),this.renderer.listen("document","click",this.handleDocumentClick.bind(this))}showMenuAtPosition(e,t,n){this.resetMenu(),this.showContextMenu(e,t,n)}showDefaultContextMenu(e,t){this.resetMenu();let n=[{label:"\u65B0\u5EFA",icon:"fas fa-plus",children:[{label:"\u6587\u4EF6",icon:"fas fa-file",action:()=>console.log("\u65B0\u5EFA\u6587\u4EF6")},{label:"\u6587\u4EF6\u5939",icon:"fas fa-folder",action:()=>console.log("\u65B0\u5EFA\u6587\u4EF6\u5939")},{separator:!0},{label:"\u5FEB\u6377\u65B9\u5F0F",icon:"fas fa-link",action:()=>console.log("\u65B0\u5EFA\u5FEB\u6377\u65B9\u5F0F")}]},{label:"\u6253\u5F00",icon:"fas fa-folder-open",action:()=>console.log("\u6253\u5F00")},{label:"\u7C98\u8D34",icon:"fas fa-paste",disabled:!0},{separator:!0},{label:"\u5237\u65B0",icon:"fas fa-sync-alt",action:()=>console.log("\u5237\u65B0")},{label:"\u67E5\u770B",children:[{label:"\u5927\u56FE\u6807",icon:"fas fa-th-large",action:()=>console.log("\u5927\u56FE\u6807")},{label:"\u5C0F\u56FE\u6807",icon:"fas fa-th",action:()=>console.log("\u5C0F\u56FE\u6807")},{label:"\u5217\u8868",icon:"fas fa-bars",action:()=>console.log("\u5217\u8868")},{label:"\u8BE6\u7EC6\u4FE1\u606F",icon:"fas fa-list-ul",action:()=>console.log("\u8BE6\u7EC6\u4FE1\u606F")}]},{label:"\u5C5E\u6027",icon:"fas fa-cogs",action:()=>console.log("\u5C5E\u6027")}];this.showContextMenu(e,t,n)}showContextMenu(e,t,n){this.currentMenuItems=n,this.setPosition(this.mainMenu.nativeElement,e,t),this.showMenu(this.mainMenu.nativeElement)}resetMenu(){this.hideMenu(this.mainMenu.nativeElement),this.hideMenu(this.subMenu.nativeElement),this.activeSubMenuItemIndex=null,this.currentSubMenuItems=[]}showMenu(e){this.renderer.removeClass(e,"show"),requestAnimationFrame(()=>{this.renderer.addClass(e,"show")})}hideMenu(e){this.renderer.removeClass(e,"show")}setPosition(e,t,n){let i=e.getBoundingClientRect(),r=t,c=n;t+i.width>window.innerWidth&&(r=window.innerWidth-i.width-20),n+i.height>window.innerHeight&&(c=window.innerHeight-i.height-20),this.renderer.setStyle(e,"left",`${r}px`),this.renderer.setStyle(e,"top",`${c}px`)}onItemEnter(e,t,n){if(!n.children||n.children.length===0){this.hideMenu(this.subMenu.nativeElement);return}this.currentSubMenuItems=n.children;let i=t.target.getBoundingClientRect();this.setPosition(this.subMenu.nativeElement,i.right,i.top),this.showMenu(this.subMenu.nativeElement),this.activeSubMenuItemIndex=e}onItemLeave(e,t){t.children&&setTimeout(()=>{this.activeSubMenuItemIndex!==e&&this.hideMenu(this.subMenu.nativeElement)},150)}onItemClick(e){e.action&&e.action(),this.hideMenu(this.mainMenu.nativeElement),this.hideMenu(this.subMenu.nativeElement)}handleDocumentClick(e){let t=e.target,n=this.mainMenu.nativeElement,i=this.subMenu.nativeElement;!n.contains(t)&&!i.contains(t)&&(this.hideMenu(n),this.hideMenu(i))}isSeparator(e){return e.separator===!0}hasChildren(e){return e.children!=null&&e.children.length>0}static \u0275fac=function(t){return new(t||o)(P(y))};static \u0275cmp=O({type:o,selectors:[["app-comp-menu"]],viewQuery:function(t,n){if(t&1&&(M(A,5),M($,5),M(Q,5)),t&2){let i;_(i=g())&&(n.mainMenu=i.first),_(i=g())&&(n.subMenu=i.first),_(i=g())&&(n.testArea=i.first)}},decls:11,vars:3,consts:[["testArea",""],["mainMenu",""],["subMenu",""],[1,"test-area"],[1,"context-menu"],[1,"menu"],[3,"menu-item","separator","mouseenter","mouseleave","click",4,"ngFor","ngForOf"],[3,"menu-item","separator","click",4,"ngFor","ngForOf"],[3,"mouseenter","mouseleave","click"],[1,"menu-item-content"],["class","menu-icon",3,"class",4,"ngIf"],[1,"menu-label"],["class","submenu-arrow",4,"ngIf"],[1,"menu-icon"],[1,"submenu-arrow"],[3,"click"]],template:function(t,n){t&1&&(s(0,"div",3,0),f(2,` \u{1F50D} \u53F3\u952E\u70B9\u51FB\u8FD9\u91CC\u6D4B\u8BD5\u83DC\u5355
`),u(),s(3,"div",4,1)(5,"ul",5),m(6,N,6,7,"li",6),u()(),s(7,"div",4,2)(9,"ul",5),m(10,z,5,6,"li",7),u()()),t&2&&(l(6),p("ngForOf",n.currentMenuItems),l(4),p("ngForOf",n.currentSubMenuItems||S(2,B)))},dependencies:[T,k,D,F],styles:[".test-area[_ngcontent-%COMP%]{width:100%;height:500px;border:1px solid black}.context-menu[_ngcontent-%COMP%]{position:fixed;z-index:9999;background-color:#2c2c2c;border-radius:6px;box-shadow:0 4px 12px #0000004d;padding:8px 0;min-width:180px;opacity:0;pointer-events:none;transition:opacity .2s ease-in-out;display:block}.context-menu.show[_ngcontent-%COMP%]{opacity:1;pointer-events:auto}.context-menu[_ngcontent-%COMP%]   .menu[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.context-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]{padding:8px 12px 8px 36px;color:#fff;position:relative;cursor:pointer;transition:background-color .2s ease}.context-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]:hover{background-color:#444}.context-menu[_ngcontent-%COMP%]   .menu-item.separator[_ngcontent-%COMP%]{padding:0;height:1px;background-color:#ffffff1a;margin:6px 0}.context-menu[_ngcontent-%COMP%]   .menu-item[_ngcontent-%COMP%]   .submenu-arrow[_ngcontent-%COMP%]{position:absolute;right:12px;top:50%;transform:translateY(-50%);font-size:10px;color:#aaa}.context-menu[_ngcontent-%COMP%]   .menu-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);font-size:14px;color:#aaa}.context-menu[_ngcontent-%COMP%]   .menu-label[_ngcontent-%COMP%]{margin-left:24px}"]})};export{V as CompMenu};
